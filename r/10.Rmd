## 正規分布のおさらい
```{r}
x <- seq(10, 50, 0.1)
y <- dnorm(x, 30, 4)
plot(x, y, type="l")
```


> 上記の正規分布は N(30, 16)

## これだけ覚えておくとよいです

- 正規分布は、平均値と分散（標準偏差）の2つのパラメータが必要


## 点推定

- 点推定では「標本統計量」を使って、母数を1つの値で予測する
- 母平均の点推定には、標本平均を使う
- 母平均の点推定は、母平均の「不偏推定量」である
- 母分散の点推定には、標本分散を使ってはいけない
- 標本分散は、母分散の「不偏推定量」ではない
$$
\bar{x} = \frac{1}{n} \sum_{i=1}^n x_i
$$

```{r}
tomato<-c(31.8,36.4,32.7,29.2,25.3)
tomato

mean(tomato)

```


$$
s^2 = \frac{1}{n} \sum_{i=1}^n (x_i - \bar{x})^2
$$

### 母分散の点推定の注意

- 標本分散は、実は、母分散の推定量として使ってはいけない
  - 理由
    - 標本分散は母分散の値よりも小さな値になってしまうから


```{r}
tomato_mean<-30
sum((tomato-tomato_mean)**2)/length(tomato)
```

## 不偏分散

- 母分散の不偏推定量
- 以下のように計算する

$$
s^2 = \frac{1}{n} \sum_{i=1}^n (x_i - \bar{x})^2
$$

> 不偏分散は、通常の分散であれば、1/n するところを、1/(n-1) するだけ。
tomato <- c(31.8, 36.4, 32.7, 29.2, 25.3)

# 標本分散: 13.6776
# 不偏分散
```{r}
tomato_mean <- mean(tomato)
sum((tomato - tomato_mean)^2) / (length(tomato) - 1)
```
## 参考: Rのvar関数

- Rのvar関数は、不偏分散を計算する関数です
  - つまり、1/(n-1) で計算しています

```{r}
# 不偏分散
tomato <- c(31.8, 36.4, 32.7, 29.2, 25.3)
var(tomato)
```

## 分散についてまとめ

- 「分散」と呼ぶとき
  - それが、通常の分散か、不偏分散か、識別することが大切
- 推計統計（区間推定、仮説検定）では不偏分散を使う
- なぜか言語によって、分散の実装は異なる
  - R: var関数のみ（不偏分散の関数しかない）
  - Python:
    - numpyだと、通常の分散用の関数、不偏分散用の関数がある
  - Excel: 通常の分散用の関数、不偏分散用の関数がある

```{r}
# 10000回やってみる
result <- numeric(10000)

for (i in 1:10000) {
  x <- rnorm(5, 30, 4)
  mean_x <- mean(x)
  result[i] <- sum((x - mean_x)^2) / (length(x)-1)
}

mean(result)

```