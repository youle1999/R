- 500m1 の紙パックのジュースがあります
- A さんは、本当に 500m1 入っているの？と疑問を持ちました
- メーカーの担当者に問い合わせたところ、 
「うちのジュースは、N(500, 4^2) の正規分布に従っている」と回答があった 
- この紙パックのジュースが 500〜504m1 である確率はいくらでしょう

## 正規分布の読み方
$$
N(500, 16)
$$

# N (500, 16) のグラフを描画する
```{r}
x <- seq(480, 520, 0.1)
y <- dnorm(x, 500, 4)
plot(x, y, type="l")

# 500ml, 504ml に線を引く
abline(v=500)
abline(v=504)

# 確率の計算
p1<-pnorm(500, 500, 4)
p2<-pnorm(504,500,4)
p2

p2-p1
```

## 問題

1. この紙パックのジュースが 500～504ml である確率はいくらでしょう
   - 0.3413447

2. この紙パックのジュースが 496～504ml である確率はいくらでしょう
   - ???
   
```{r}
x <- seq(480, 520, 0.1)
y <- dnorm(x, 500, 4)
plot(x, y, type="l")

# 500ml, 504ml に線を引く
abline(v=500)
abline(v=504)

# 確率の計算
p1<-pnorm(496, 500, 4)
p2<-pnorm(504,500,4)
p2

p2-p1
```

## まとめ

- 正規分布は、平均から ±1 標準偏差の間に、約 68% のデータが含まれる

### 参考

- N(80, 100) の正規分布において、60～100 の間には何パーセントのデータが含まれる？
  - 約：95%

- 正規分布は、平均から ±2 標準偏差の間に、約 68% のデータが含まれる
```{r}
x <- seq(-3, 3, 0.1)
y <- dnorm(x, 0, 1)
plot(x, y, type="l")
abline(V=-1)
abline(V=+1)
```
# 母集団分布と標本分布

- たとえば、母集団分布が N(30, 16) のとき
  - サンプルサイズ 4 の標本から標本平均を計算します
  - この標本平均の従う確率分布は N(30, 4) になる
  - 分散が 1/4 になる

- 標本分布（※標本平均の分布のこと）

$$
N(μ, σ^2 / n)
$$

- n: サンプルサイズ

- つまり、標本平均のしたがう標本分布の分散は、母分散を 1/n にした値になる
- 標本平均の分散のことを「標準誤差 SE: Standard Error」といいます

# 区間推定 - ミニトマトの母平均の推定

- 母平均: μ、母分散: 16 の正規母集団から、サンプルサイズ 4 の標本を作成した
  - 29.5, 25.8, 25.1, 33.6

```{R}
sigma<-4
tomato_sample<-c(29.5,25.8,25.1,33.6)
tomato_sample_mean<-mean(tomato_sample)
tomato_sample_mean
```



```{r}
# 母分散 16, 母標準偏差 4
sigma <- 10
tomato_sample <- c(76,79,80,82,83,85)

# 標本平均を計算する
tomato_sample_mean <- mean(tomato_sample)
tomato_sample_mean # 標本平均: 28.5

# サンプルサイズ
tomato_sample_size <- length(tomato_sample)
tomato_sample_size # サンプルサイズ: 4

# 標準誤差を計算する
# SE = σ / √n
se <- sigma / sqrt(tomato_sample_size)
se # 標準誤差: 2

# 標本平均から ± 2.58 標準誤差 (標準偏差) の範囲が 99% 信頼区間となる
from <- tomato_sample_mean - 1.96 * se
to <- tomato_sample_mean + 1.96 * se

paste(from, "〜", to)

```

## t分布について

- t分布は正規分布とよく似た確率分布
- 自由度によって、確率分布が変化する

$$
x \sim t(df)
$$


```{r}
x <- seq(-5, 5, 0.1)
# t分布の確率密度関数 dt
y <- dt(x, df=10) # df=自由度
plot(x, y, type="l")

```


